<html>
  <head>
    <title>ESP8266 Web Server POST handling</title>
    <style>
      body {
        background-color: #cccccc;
        font-family: Arial, Helvetica, Sans-Serif;
        color: #000088;
      }
    </style>
  </head>
  <body>
    <h1>Set Light Color /postcolor/</h1>
    <br />
    <form
      method="post"
      enctype="application/x-www-form-urlencoded"
      action="/postcolor/"
    >
      <label for="brightness">Brightness (1 - 255):</label>
      <input
        type="number"
        id="brightness"
        name="brightness"
        min="1"
        max="255"
      />
      <input type="checkbox" id="power1" name="power1" value="power1" />
      <label for="power1"> Power</label><br />
      <input type="color" id="favcolor" name="favcolor" /><br />
      <label for="favcolor"> Color</label><br />
      <input type="submit" value="Submit" />
    </form>
    <h1>Set Alarm Time /postalarm/</h1>

    <h2 id="exact-time" data-exact-time="1705768445571"></h2>

    <br />
    <form
      method="post"
      enctype="application/x-www-form-urlencoded"
      action="/postalarm/"
    >
      <label for="timenow">Select current time:</label>
      <input type="time" id="timenow" name="timenow" />
      <label for="alarm">Select alarm time:</label>
      <input type="time" id="alarm" name="alarm" />
      <input type="submit" value="Submit" />
    </form>
    <script>
      const el = document.getElementById("exact-time");

      const exactMS = new Date(
        Number(el.dataset.exactTime)
      ).getUTCMilliseconds();

      const realStartTimeMS = Date.now();
      const diff = realStartTimeMS - exactMS;

      setInterval(async () => {
        const result = await fetch("http://localhost:7500", {
          headers: {
            "Content-Type": "application/json",
          },
        }).then((r) => r.json());

        const updatedTime = result.currentTime;

        el.textContent = updatedTime;
        // const updatedTime = new Date(Date.now() + diff);

        // el.textContent = `${updatedTime.getHours()}:${updatedTime.getMinutes()}:${updatedTime.getSeconds()}`;
      }, 1000);
    </script>
  </body>
</html>
